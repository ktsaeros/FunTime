Write-Output 'Recent power events:'; Get-WinEvent -FilterHashtable @{LogName='System';Id=@(1,42,107,6005,6006,6008);StartTime=(Get-Date).AddDays(-14)} | Select-Object TimeCreated,@{Name='EventType';Expression={switch ($_.Id){6005{'Startup'}6006{'Shutdown'}6008{'Unexpected Shutdown'}1{'Wake'}42{'Sleep'}107{'Resume'}default{"ID $_"}}}},Message; Write-Output ''; Write-Output 'Current power settings:'; $g=(powercfg /getactivescheme|Select-String 'Power Scheme GUID: ([\w-]+)'|%{$_.Matches[0].Groups[1].Value}); $s=powercfg /query $g SUB_SLEEP STANDBYIDLE; $h=powercfg /query $g SUB_SLEEP HIBERNATEIDLE; Write-Output ('Sleep after GUID: {0}' -f ($s|Select-String 'Power Setting GUID'|%{$_.Line.Trim()})); Write-Output ('Friendly name: {0}' -f ($s|Select-String 'GUID Alias'|%{$_.Line.Trim()})); Write-Output ("  Plugged In: {0} minutes" -f ([convert]::ToInt32(($s|Select-String 'Current AC Power Setting Index'|%{($_.Line -split ':')[-1].Trim()}),16)/60)); Write-Output ("  On Battery: {0} minutes" -f ([convert]::ToInt32(($s|Select-String 'Current DC Power Setting Index'|%{($_.Line -split ':')[-1].Trim()}),16)/60)); Write-Output ''; Write-Output ('Hibernate after GUID: {0}' -f ($h|Select-String 'Power Setting GUID'|%{$_.Line.Trim()})); Write-Output ('Friendly name: {0}' -f ($h|Select-String 'GUID Alias'|%{$_.Line.Trim()})); Write-Output ("  Plugged In: {0} minutes" -f ([convert]::ToInt32(($h|Select-String 'Current AC Power Setting Index'|%{($_.Line -split ':')[-1].Trim()}),16)/60)); Write-Output ("  On Battery: {0} minutes" -f ([convert]::ToInt32(($h|Select-String 'Current DC Power Setting Index'|%{($_.Line -split ':')[-1].Trim()}),16)/60))