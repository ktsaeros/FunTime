$log = "C:\Aeros\DellCmdUninstall.log"; New-Item -ItemType Directory -Force -Path (Split-Path $log) | Out-Null; $app = Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -like "Dell Command | Update*" }; if ($app) { $guid = $app.IdentifyingNumber; Add-Content $log "$(Get-Date) - Found Dell Command | Update with GUID $guid. Uninstalling..."; Start-Process "msiexec.exe" -ArgumentList "/x $guid /quiet /norestart" -Wait; Start-Sleep -Seconds 5; $check = Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -like 'Dell Command | Update*' }; if ($check) { Add-Content $log "$(Get-Date) - Uninstall attempted, but Dell Command | Update still found."; Write-Output "Uninstall may have failed." } else { Add-Content $log "$(Get-Date) - Successfully uninstalled Dell Command | Update."; Write-Output "Uninstall successful." } } else { Add-Content $log "$(Get-Date) - Dell Command | Update was not installed."; Write-Output "Dell Command | Update was not installed." }